{
  "info": {
    "_postman_id": "b5b8d1a0-2b6d-4c5c-8a1f-8b2a2a3d9b1d",
    "name": "Budexpert API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    { "key": "baseUrl", "value": "http://127.0.0.1:5001/api" },
    { "key": "adminToken", "value": "" },
    { "key": "adminUser", "value": "admin" },
    { "key": "adminPass", "value": "admin123" }
  ],
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "Login (admin)",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status 200', function () { pm.response.to.have.status(200); });",
                  "var json = pm.response.json();",
                  "if (json && json.token) {",
                  "  pm.collectionVariables.set('adminToken', json.token);",
                  "  pm.environment.set('adminToken', json.token);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"{{adminUser}}\",\n  \"password\": \"{{adminPass}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "login"]
            }
          }
        }
      ]
    },
    {
      "name": "Products",
      "item": [
        {
          "name": "List products",
          "request": {
            "method": "GET",
            "url": { "raw": "{{baseUrl}}/products", "host": ["{{baseUrl}}"], "path": ["products"] }
          }
        },
        {
          "name": "List products (pagination)",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/products?page=1&limit=20",
              "host": ["{{baseUrl}}"],
              "path": ["products"],
              "query": [
                { "key": "page", "value": "1" },
                { "key": "limit", "value": "20" }
              ]
            }
          }
        },
        {
          "name": "Product counts",
          "request": {
            "method": "GET",
            "url": { "raw": "{{baseUrl}}/products/counts", "host": ["{{baseUrl}}"], "path": ["products", "counts"] }
          }
        },
        {
          "name": "Get product by id",
          "request": {
            "method": "GET",
            "url": { "raw": "{{baseUrl}}/products/:id", "host": ["{{baseUrl}}"], "path": ["products", ":id"] }
          }
        },
        {
          "name": "Create product (admin)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"New product\",\n  \"price\": 100,\n  \"stock\": 10,\n  \"unit\": \"шт\",\n  \"sku\": \"new-sku\",\n  \"description\": \"...\",\n  \"discount\": 0\n}"
            },
            "url": { "raw": "{{baseUrl}}/products", "host": ["{{baseUrl}}"], "path": ["products"] }
          }
        },
        {
          "name": "Update product (admin)",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ],
            "body": { "mode": "raw", "raw": "{\n  \"price\": 120\n}" },
            "url": { "raw": "{{baseUrl}}/products/:id", "host": ["{{baseUrl}}"], "path": ["products", ":id"] }
          }
        },
        {
          "name": "Delete product (admin)",
          "request": {
            "method": "DELETE",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "url": { "raw": "{{baseUrl}}/products/:id", "host": ["{{baseUrl}}"], "path": ["products", ":id"] }
          }
        },
        {
          "name": "Bulk create/upsert products (admin)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ],
            "body": {
              "mode": "raw",
              "raw": "[\n  {\n    \"name\": \"Bulk product 1\",\n    \"price\": 10,\n    \"sku\": \"bulk-1\"\n  }\n]"
            },
            "url": { "raw": "{{baseUrl}}/products/bulk", "host": ["{{baseUrl}}"], "path": ["products", "bulk"] }
          }
        },
        {
          "name": "Delete ALL products (admin) (?confirm=true)",
          "request": {
            "method": "DELETE",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "url": {
              "raw": "{{baseUrl}}/products?confirm=true",
              "host": ["{{baseUrl}}"],
              "path": ["products"],
              "query": [{ "key": "confirm", "value": "true" }]
            }
          }
        },
        {
          "name": "Export products CSV (admin)",
          "request": {
            "method": "GET",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "url": { "raw": "{{baseUrl}}/products/export/all", "host": ["{{baseUrl}}"], "path": ["products", "export", "all"] }
          }
        },
        {
          "name": "Export products XLSX (admin)",
          "request": {
            "method": "GET",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "url": { "raw": "{{baseUrl}}/products/export/xlsx", "host": ["{{baseUrl}}"], "path": ["products", "export", "xlsx"] }
          }
        },
        {
          "name": "Import products XLSX (admin)",
          "request": {
            "method": "POST",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "body": {
              "mode": "formdata",
              "formdata": [
                { "key": "file", "type": "file", "src": "" }
              ]
            },
            "url": { "raw": "{{baseUrl}}/products/import/xlsx", "host": ["{{baseUrl}}"], "path": ["products", "import", "xlsx"] }
          }
        }
      ]
    },
    {
      "name": "Orders",
      "item": [
        {
          "name": "Create order (public)",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"customerName\": \"John\",\n  \"phone\": \"+380000000000\",\n  \"address\": \"Kyiv\",\n  \"items\": [{\"productId\": \"<productId>\", \"quantity\": 1}]\n}"
            },
            "url": { "raw": "{{baseUrl}}/orders", "host": ["{{baseUrl}}"], "path": ["orders"] }
          }
        },
        {
          "name": "List orders (admin)",
          "request": {
            "method": "GET",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "url": { "raw": "{{baseUrl}}/orders", "host": ["{{baseUrl}}"], "path": ["orders"] }
          }
        },
        {
          "name": "Get order by id (admin)",
          "request": {
            "method": "GET",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "url": { "raw": "{{baseUrl}}/orders/:id", "host": ["{{baseUrl}}"], "path": ["orders", ":id"] }
          }
        },
        {
          "name": "Update order (admin)",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ],
            "body": { "mode": "raw", "raw": "{\n  \"status\": \"done\",\n  \"note\": \"ok\"\n}" },
            "url": { "raw": "{{baseUrl}}/orders/:id", "host": ["{{baseUrl}}"], "path": ["orders", ":id"] }
          }
        },
        {
          "name": "Delete order (admin)",
          "request": {
            "method": "DELETE",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "url": { "raw": "{{baseUrl}}/orders/:id", "host": ["{{baseUrl}}"], "path": ["orders", ":id"] }
          }
        }
      ]
    },
    {
      "name": "Categories",
      "item": [
        {
          "name": "List categories",
          "request": {
            "method": "GET",
            "url": { "raw": "{{baseUrl}}/categories", "host": ["{{baseUrl}}"], "path": ["categories"] }
          }
        },
        {
          "name": "List categories (by parent)",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/categories?parent=null",
              "host": ["{{baseUrl}}"],
              "path": ["categories"],
              "query": [{ "key": "parent", "value": "null" }]
            }
          }
        },
        {
          "name": "Get category by id",
          "request": {
            "method": "GET",
            "url": { "raw": "{{baseUrl}}/categories/:id", "host": ["{{baseUrl}}"], "path": ["categories", ":id"] }
          }
        },
        {
          "name": "Create category (admin)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ],
            "body": { "mode": "raw", "raw": "{\n  \"name\": \"New Category\",\n  \"parent\": null\n}" },
            "url": { "raw": "{{baseUrl}}/categories", "host": ["{{baseUrl}}"], "path": ["categories"] }
          }
        },
        {
          "name": "Update category (admin)",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ],
            "body": { "mode": "raw", "raw": "{\n  \"name\": \"Updated Category\"\n}" },
            "url": { "raw": "{{baseUrl}}/categories/:id", "host": ["{{baseUrl}}"], "path": ["categories", ":id"] }
          }
        },
        {
          "name": "Delete category (admin)",
          "request": {
            "method": "DELETE",
            "header": [{ "key": "Authorization", "value": "Bearer {{adminToken}}" }],
            "url": { "raw": "{{baseUrl}}/categories/:id", "host": ["{{baseUrl}}"], "path": ["categories", ":id"] }
          }
        },
        {
          "name": "Reassign category (admin)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ],
            "body": { "mode": "raw", "raw": "{\n  \"fromId\": \"<fromId>\",\n  \"toId\": \"<toId>\"\n}" },
            "url": { "raw": "{{baseUrl}}/categories/reassign", "host": ["{{baseUrl}}"], "path": ["categories", "reassign"] }
          }
        }
      ]
    },
    {
      "name": "Uploads",
      "item": [
        {
          "name": "Upload image (Cloudinary)",
          "request": {
            "method": "POST",
            "body": {
              "mode": "formdata",
              "formdata": [
                { "key": "file", "type": "file", "src": "" }
              ]
            },
            "url": { "raw": "{{baseUrl}}/uploads", "host": ["{{baseUrl}}"], "path": ["uploads"] }
          }
        }
      ]
    },
    {
      "name": "Leads",
      "item": [
        {
          "name": "Create lead",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"call\",\n  \"name\": \"Client\",\n  \"phone\": \"+380000000000\"\n}"
            },
            "url": { "raw": "{{baseUrl}}/leads", "host": ["{{baseUrl}}"], "path": ["leads"] }
          }
        },
        {
          "name": "List leads",
          "request": {
            "method": "GET",
            "url": { "raw": "{{baseUrl}}/leads", "host": ["{{baseUrl}}"], "path": ["leads"] }
          }
        },
        {
          "name": "List leads (pagination)",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/leads?page=1&limit=20",
              "host": ["{{baseUrl}}"],
              "path": ["leads"],
              "query": [
                { "key": "page", "value": "1" },
                { "key": "limit", "value": "20" }
              ]
            }
          }
        },
        {
          "name": "Update lead status",
          "request": {
            "method": "PUT",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": { "mode": "raw", "raw": "{\n  \"status\": \"done\"\n}" },
            "url": { "raw": "{{baseUrl}}/leads/:id", "host": ["{{baseUrl}}"], "path": ["leads", ":id"] }
          }
        }
      ]
    },
    {
      "name": "Nova Poshta",
      "item": [
        {
          "name": "Cities (search)",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/post/cities?q=Київ",
              "host": ["{{baseUrl}}"],
              "path": ["post", "cities"],
              "query": [{ "key": "q", "value": "Київ" }]
            }
          }
        },
        {
          "name": "Offices by cityRef",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/post/offices?cityRef=<ref>",
              "host": ["{{baseUrl}}"],
              "path": ["post", "offices"],
              "query": [{ "key": "cityRef", "value": "<ref>" }]
            }
          }
        }
      ]
    },
    {
      "name": "Banner",
      "item": [
        {
          "name": "Get banner (public)",
          "request": {
            "method": "GET",
            "url": { "raw": "{{baseUrl}}/banner", "host": ["{{baseUrl}}"], "path": ["banner"] }
          }
        },
        {
          "name": "Update banner (admin)",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{adminToken}}" }
            ],
            "body": { "mode": "raw", "raw": "{\n  \"images\": [{\"url\": \"https://example.com/1.jpg\"}]\n}" },
            "url": { "raw": "{{baseUrl}}/banner", "host": ["{{baseUrl}}"], "path": ["banner"] }
          }
        }
      ]
    }
  ]
}
